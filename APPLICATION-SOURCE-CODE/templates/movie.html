{% extends 'base.html' %}

{% block title %} {{query}}  {% endblock %}

{% block head %}
<link rel="stylesheet" href="static/movie.css">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Limelight&family=Staatliches&display=swap" rel="stylesheet">

<script>
    var availableTags = {{ movies_names|safe }};
  $( function() {
    $("#searchBar").autocomplete({
		source: function(request, response) {
			var results = $.ui.autocomplete.filter(availableTags, request.term);
			response(results.slice(0, 10));
		}	
  		});
	});
</script>

{% endblock %}

{% block body %}

<!-- top nav bar - mhamad -->
<nav id="topnav" class="navbar navbar-dark">
	<div class="container-fluid">
	  <a id="topnav-brand" href="/" class="navbar-brand">Cinema Bay</a>
	  <form class="d-flex" action="/search" method="GET">
		<input class="form-control me-2 mr-2" id="searchBar" type="search" name="query" placeholder="Movie Search" aria-label="Search" required>
		<button class="btn btn-outline-success" type="submit">Search</button>
	  </form>
	</div>
</nav>

<!--------------------------------------------------------->

<div class="container m-0 p-0 mw-100">
	
	<div class="row movie-container p-4">
		<div class="col-md-3  no-gutters  order-second order-sm-first">
			<div id="accordion" class="col-12">
				<div class="card" id="ac-card1">
					<div class="card-header" id="headingOne">
					    <h5 class="mb-0">
					        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
					          Cool feature
					        </button>
					    </h5>
					</div>

					<div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
					    <div class="card-body">
					        <p class="card-text">
								Empty for now
							</p>
					    </div>
					</div>
				</div>
				<div class="card" id="Awards">
					<div class="card-header" id="headingTwo">
					    <h5 class="mb-0">
					        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
					          Famous Awards
					        </button>
					    </h5>
					</div>
					<div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
					    <div class="card-body">
							<p class="card-text">
								{% for award in context['awards'] %}
									<span>{{'|' if loop.index|string != '1' }} {{ award }} </span>
								{% endfor %}
							</p>
					     </div>
					</div>
				</div>

					<!-- cast card with carousel - mhamad-->
				<div class="card" id="ac-card3">
					<div class="card-header" id="headingThree">
					    <h5 class="mb-0">
					        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
					        Top Cast
					        </button>
					    </h5>
					</div>
						
					<div id="collapseThree" class="collapse show" aria-labelledby="headingThree" data-parent="#accordion">
					    <div class="card-body" id="cast">
							<div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
								<div class="carousel-inner">
								{% for actor in topcast %}
									<div class="carousel-item {{ 'active' if loop.index|string == '1' }}">
										<img class="d-block w-100" src="{{ actor['image'] }}" alt="First slide" style="height: 200px;">
										<div class="d-block">
											<h5 class="text-center">{{ actor["name"] }}</h5>
											<h5 class="text-center">Avg Movie Rating: {{ actor["avg"]|string}} /10</h5>
										</div>
									</div>
								{% endfor %}
								</div>
								<a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
									<span class="carousel-control-prev-icon" aria-hidden="true"></span>
									<span class="sr-only">Previous</span>
								</a>
								<a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
									<span class="carousel-control-next-icon" aria-hidden="true"></span>
									<span class="sr-only">Next</span>
								</a>
							</div>
					    </div>
					</div>
				</div>
			</div>
			<div class="card no-gutters" id="movieTrailer">
				<iframe  src="{{ context['trailer'] }}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
			</div>
		</div>

	<!--------- middle column --- sumaya -------->
		<div class="col-md-6 order-first order-sm-second">
			<div class="col">
			</div>
			<div class ="col row-movie">
				
					
					<div class="row no-gutters">
				<div class="col-12">
					<h2 class="movie-title" > {{ context['title'] }} </h2> <i class="fa fa-star" style="font-size:24px;"></i>{{ context['raiting']|int }}<sub>/10</sub>
					<hr> 
				</div>
					<div class="col-12">
						<img class="img-fluid float-right col-5" src="{{ context['image'] }}">
					<p> {{ context['summary'] }} </p>	

				</div>	
				
				
				 </div>
  				<div class="card border-0" id="mid-navbar">
				  <div class="card-header">
				    <ul class="nav nav-tabs border-0 d-flex justify-content-between">
				      <li class="nav-item">
				      <button class="btn btn-link  collapsed"  data-toggle="collapse" data-target="#storyline" aria-pressed="true" aria-controls="storyline"><h5>Storyline</h5></button>
				      </li>
				      <li class="nav-item">
				       <button class="btn btn-link collapsed"  data-toggle="collapse" data-target="#tab2" aria-expanded="false" aria-controls="tab2"><h5>Academy Awards</h5></button>
				      </li>
				      <li class="nav-item">
				       <button class="btn btn-link collapsed"  data-toggle="collapse" data-target="#tab3" aria-expanded="false" aria-controls="tab3"><h5>tab3</h5></button>
				      </li>
				    </ul>
				  </div>
				  <div class="card-body" >
				  	<div class="collapse show" id="storyline" data-parent="#mid-navbar">
				  	<div class="card border-0">
				  		<div class="card-body">
				  			<p  class="card-text ">{{ context['summary'] }}</p>
				  		</div>
				  	</div>
				    </div>
				    <div class="collapse" id="tab2" data-parent="#mid-navbar">
				    <div class="card border-0">
				    	<div class="card-body">
				    		<h5>winner</h5>
				    		<ul>
				    			<li>Best Performance by an Actor in a Supporting Role
								Heath Ledger</li>
				    			<li>Best Achievement in Sound Editing
									Richard King</li>
				    		</ul>

				    		<h5>Nominee</h5>
				    		<ul>
				    			<li>Best Achievement in Cinematography
								Wally Pfister</li>
				    			<li>Best Achievement in Film Editing
								Lee Smith</li>
				    		</ul>
				   
				  </div>
				    </div>
				    </div>
				    <div class="collapse" id="tab3" data-parent="#mid-navbar">
				   <div class="card border-0" >
				   	 <div class="card-body">
				   	 	 <p  class="card-text collapse"></p>
				   	 </div>
				   </div> 
				   </div>
				    </div>
				    
				</div>

				 
				</div>
				<div class="col-12 no-gutters">
					
				</div>
		</div>
		<!-------------- end of middle column --- sumaya --------------->
			
			
		<div class="col-md-3 movie-RSD align-content-center xs-order-3">
			<div class="card">
				<div class="card-body">
					<h5 class="card-title">PREMIERE</h5>
					<p class="card-text">{{ context['year'] }}</p>
				</div>
			</div>

		<!--**********************************-->	
			
			<div class="card">
				<div class="card-body">
					<h5 class="card-title" >DIRECTOR</h5>
					<p class="card-text">{{ context['director'] }}</p>
				</div>
			</div>

		<!--**********************************-->	
			
			<div class="card">
				<div class="card-body">
					<h5 class="card-title">Filming Locations</h5>
					
					<p class="card-text">
						{% for location in context['locations'] %}
							<span>{{'|' if loop.index|string != '1' }} {{ location }}</span>
						{% endfor %}
					</p>
				</div>
			</div>

		<!--**********************************-->	

			<div class="card">
				<div class="card-body">
					<h5 class="card-title">GENRE</h5>
					<p class="card-text">
						{% for genre in context['genres'] %}
							<span>{{'|' if loop.index|string != '1' }} {{ genre }}</span>
						{% endfor %}
					</p>
				</div>
			</div>

		<!--**********************************-->
		<div class="card">
			<div class="card-body">
				<h5 class="card-title">Providers </h5>
				<p class="card-text">
					{% for provider in context['providers'] %}
						<span>{{'|' if loop.index|string != '1' }} {{ provider }} </span>
					{% endfor %}
				</p>
			</div>
		</div>
			
		<!--**********************************-->
	
		</div>
	</div>
</div>



<h3 class="font-weight-light text-center mt-4 mb-3">More Movies Like This</h3>
<div class="container">
		<div id="myCarousel" class="carousel slide" data-ride="carousel">
			
			<ol class="carousel-indicators">
			{% for i in range((recs|length)// 5 ) %}
			<li id="carousel-indicator" data-target="#myCarousel" data-slide-to="{{i}}" class="{{ 'active' if loop.index|string == "1" }}"></li>
			{% endfor %}
			</ol>
			
			<div class="carousel-inner" role="listbox">
			{% for row in recs|batch(5) %}
				<div class="carousel-item item {% if loop.index|string == '1' %} active {% endif %}">
					<div class="row h-100">
						{% for movie in row %}
						<div class="col-md-2 p-0 {% if loop.index|string != '1' %} clearfix d-none d-md-block {% endif %}">
							<div class="card h-100">
								<a class="h-100" href="/search?id={{ movie['id'] }}">
									<img class="card-img h-100 " src="{{movie['poster'] }}"
									alt="Card image cap">
								</a>
							</div>
						</div>
						{% endfor %}

					</div>
				</div>
			{% endfor %}
			</div>

			<a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev" style="width: 5%;">
				<span class="carousel-control-prev-icon" aria-hidden="true"></span>
				<span class="sr-only">Previous</span>
			</a>
			<a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next" style="width: 5%;">
				<span class="carousel-control-next-icon" aria-hidden="true"></span>
				<span class="sr-only">Next</span>
			</a>
		</div>	
</div>
<!-- more like this carousel -->
	<script>

		//var btn = document.getElementById("myBtn");

		function myFunction() {
			var x = document.getElementById("myBtn").textContent;
			if (x=="Read more") {
				document.getElementById("myBtn").textContent="Read less";
			} else{
				document.getElementById("myBtn").textContent="Read more";
			}
		}
	</script>
	
{% endblock %}
